<!DOCTYPE html>
<html lang="zh">







<head>
  




  <meta name="robots" content="noindex">



  
    
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>React 18 與 Monorepo 的實際應用 | Darren</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="React 18 與 Monorepo 的實際應用" />
<meta name="author" content="Darren Tu" />
<meta property="og:locale" content="zh_TW" />
<meta name="description" content="前言 Monorepo 簡介 設置 Monorepo 1. 初始化 Nx 工作區 2. 添加 React 應用 3. 添加 React 庫 在 Monorepo 中使用 React 18 1. Concurrent Mode 2. Automatic Batching 3. Suspense for Data Fetching 總結 參考資料 前言 在現代前端開發中，Monorepo 已經成為管理大型代碼庫的一種流行方式。React 18 帶來了許多新特性，這些特性在 Monorepo 中的應用可以進一步提升開發效率和應用性能。本文將介紹如何在 Monorepo 中實際應用 React 18。 Monorepo 簡介 Monorepo 是指將多個項目存放在同一個代碼庫中，這樣可以更好地管理依賴關係、共享代碼和統一配置。常見的 Monorepo 工具有 Lerna 和 Nx。 設置 Monorepo 首先，我們需要設置一個 Monorepo。這裡我們使用 Nx 作為示例。 1. 初始化 Nx 工作區 bash npx create-nx-workspace@latest my-workspace cd my-workspace 2. 添加 React 應用 bash nx generate @nrwl/react:application my-app 3. 添加 React 庫 bash nx generate @nrwl/react:library my-lib 在 Monorepo 中使用 React 18 1. Concurrent Mode 在 Monorepo 中，我們可以在應用和庫中使用 React 18 的 Concurrent Mode 來提升性能。 // apps/my-app/src/app/app.tsx import React, { useState, useTransition } from &#39;react&#39;; function App() { const [isPending, startTransition] = useTransition(); const [count, setCount] = useState(0); const handleClick = () =&gt; { startTransition(() =&gt; { setCount(c =&gt; c + 1); }); }; return ( &lt;div&gt; &lt;h1&gt;計數: {count}&lt;/h1&gt; &lt;button onClick={handleClick} disabled={isPending}&gt; {isPending ? &#39;更新中...&#39; : &#39;增加&#39;} &lt;/button&gt; &lt;/div&gt; ); } export default App; 2. Automatic Batching 自動批處理功能可以在 Monorepo 中的多個應用和庫中使用，以減少重新渲染次數。 // libs/my-lib/src/lib/my-lib.tsx import React, { useState } from &#39;react&#39;; export function MyLib() { const [count, setCount] = useState(0); const [text, setText] = useState(&#39;&#39;); const handleClick = () =&gt; { setCount(c =&gt; c + 1); setText(&#39;計數已更新&#39;); }; return ( &lt;div&gt; &lt;h1&gt;計數: {count}&lt;/h1&gt; &lt;p&gt;{text}&lt;/p&gt; &lt;button onClick={handleClick}&gt;增加&lt;/button&gt; &lt;/div&gt; ); } 3. Suspense for Data Fetching 在 Monorepo 中，我們可以使用 Suspense 來處理數據加載，這使得異步操作更加簡單和直觀。 // apps/my-app/src/app/app.tsx import React, { Suspense } from &#39;react&#39;; import { MyLib } from &#39;@my-workspace/my-lib&#39;; const DataComponent = React.lazy(() =&gt; import(&#39;./data-component&#39;)); function App() { return ( &lt;div&gt; &lt;h1&gt;React 18 與 Monorepo&lt;/h1&gt; &lt;Suspense fallback={&lt;div&gt;加載中...&lt;/div&gt;}&gt; &lt;DataComponent /&gt; &lt;/Suspense&gt; &lt;MyLib /&gt; &lt;/div&gt; ); } export default App; 總結 通過在 Monorepo 中應用 React 18 的新特性，我們可以顯著提升開發效率和應用性能： Concurrent Mode 提升了應用的響應速度。 Automatic Batching 減少了重新渲染次數。 Suspense for Data Fetching 使異步操作更加簡單。 這些特性在 Monorepo 中的應用，讓我們能夠更好地管理大型代碼庫，實現高效的開發流程。 參考資料 React 官方文檔 Nx 官方文檔 React 18 發布公告" />
<meta property="og:description" content="前言 Monorepo 簡介 設置 Monorepo 1. 初始化 Nx 工作區 2. 添加 React 應用 3. 添加 React 庫 在 Monorepo 中使用 React 18 1. Concurrent Mode 2. Automatic Batching 3. Suspense for Data Fetching 總結 參考資料 前言 在現代前端開發中，Monorepo 已經成為管理大型代碼庫的一種流行方式。React 18 帶來了許多新特性，這些特性在 Monorepo 中的應用可以進一步提升開發效率和應用性能。本文將介紹如何在 Monorepo 中實際應用 React 18。 Monorepo 簡介 Monorepo 是指將多個項目存放在同一個代碼庫中，這樣可以更好地管理依賴關係、共享代碼和統一配置。常見的 Monorepo 工具有 Lerna 和 Nx。 設置 Monorepo 首先，我們需要設置一個 Monorepo。這裡我們使用 Nx 作為示例。 1. 初始化 Nx 工作區 bash npx create-nx-workspace@latest my-workspace cd my-workspace 2. 添加 React 應用 bash nx generate @nrwl/react:application my-app 3. 添加 React 庫 bash nx generate @nrwl/react:library my-lib 在 Monorepo 中使用 React 18 1. Concurrent Mode 在 Monorepo 中，我們可以在應用和庫中使用 React 18 的 Concurrent Mode 來提升性能。 // apps/my-app/src/app/app.tsx import React, { useState, useTransition } from &#39;react&#39;; function App() { const [isPending, startTransition] = useTransition(); const [count, setCount] = useState(0); const handleClick = () =&gt; { startTransition(() =&gt; { setCount(c =&gt; c + 1); }); }; return ( &lt;div&gt; &lt;h1&gt;計數: {count}&lt;/h1&gt; &lt;button onClick={handleClick} disabled={isPending}&gt; {isPending ? &#39;更新中...&#39; : &#39;增加&#39;} &lt;/button&gt; &lt;/div&gt; ); } export default App; 2. Automatic Batching 自動批處理功能可以在 Monorepo 中的多個應用和庫中使用，以減少重新渲染次數。 // libs/my-lib/src/lib/my-lib.tsx import React, { useState } from &#39;react&#39;; export function MyLib() { const [count, setCount] = useState(0); const [text, setText] = useState(&#39;&#39;); const handleClick = () =&gt; { setCount(c =&gt; c + 1); setText(&#39;計數已更新&#39;); }; return ( &lt;div&gt; &lt;h1&gt;計數: {count}&lt;/h1&gt; &lt;p&gt;{text}&lt;/p&gt; &lt;button onClick={handleClick}&gt;增加&lt;/button&gt; &lt;/div&gt; ); } 3. Suspense for Data Fetching 在 Monorepo 中，我們可以使用 Suspense 來處理數據加載，這使得異步操作更加簡單和直觀。 // apps/my-app/src/app/app.tsx import React, { Suspense } from &#39;react&#39;; import { MyLib } from &#39;@my-workspace/my-lib&#39;; const DataComponent = React.lazy(() =&gt; import(&#39;./data-component&#39;)); function App() { return ( &lt;div&gt; &lt;h1&gt;React 18 與 Monorepo&lt;/h1&gt; &lt;Suspense fallback={&lt;div&gt;加載中...&lt;/div&gt;}&gt; &lt;DataComponent /&gt; &lt;/Suspense&gt; &lt;MyLib /&gt; &lt;/div&gt; ); } export default App; 總結 通過在 Monorepo 中應用 React 18 的新特性，我們可以顯著提升開發效率和應用性能： Concurrent Mode 提升了應用的響應速度。 Automatic Batching 減少了重新渲染次數。 Suspense for Data Fetching 使異步操作更加簡單。 這些特性在 Monorepo 中的應用，讓我們能夠更好地管理大型代碼庫，實現高效的開發流程。 參考資料 React 官方文檔 Nx 官方文檔 React 18 發布公告" />
<link rel="canonical" href="http://localhost:4000/blog/2023-03-16-blog-Monorepo&react18-1/" />
<meta property="og:url" content="http://localhost:4000/blog/2023-03-16-blog-Monorepo&react18-1/" />
<meta property="og:site_name" content="Darren" />
<meta property="og:image" content="https://miro.medium.com/max/1400/1*HSisLuifMO6KbLfPOKtLow.jpeg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-03-16T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://miro.medium.com/max/1400/1*HSisLuifMO6KbLfPOKtLow.jpeg" />
<meta property="twitter:title" content="React 18 與 Monorepo 的實際應用" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Darren Tu"},"dateModified":"2024-09-14T22:27:45+08:00","datePublished":"2023-03-16T00:00:00+08:00","description":"前言 Monorepo 簡介 設置 Monorepo 1. 初始化 Nx 工作區 2. 添加 React 應用 3. 添加 React 庫 在 Monorepo 中使用 React 18 1. Concurrent Mode 2. Automatic Batching 3. Suspense for Data Fetching 總結 參考資料 前言 在現代前端開發中，Monorepo 已經成為管理大型代碼庫的一種流行方式。React 18 帶來了許多新特性，這些特性在 Monorepo 中的應用可以進一步提升開發效率和應用性能。本文將介紹如何在 Monorepo 中實際應用 React 18。 Monorepo 簡介 Monorepo 是指將多個項目存放在同一個代碼庫中，這樣可以更好地管理依賴關係、共享代碼和統一配置。常見的 Monorepo 工具有 Lerna 和 Nx。 設置 Monorepo 首先，我們需要設置一個 Monorepo。這裡我們使用 Nx 作為示例。 1. 初始化 Nx 工作區 bash npx create-nx-workspace@latest my-workspace cd my-workspace 2. 添加 React 應用 bash nx generate @nrwl/react:application my-app 3. 添加 React 庫 bash nx generate @nrwl/react:library my-lib 在 Monorepo 中使用 React 18 1. Concurrent Mode 在 Monorepo 中，我們可以在應用和庫中使用 React 18 的 Concurrent Mode 來提升性能。 // apps/my-app/src/app/app.tsx import React, { useState, useTransition } from &#39;react&#39;; function App() { const [isPending, startTransition] = useTransition(); const [count, setCount] = useState(0); const handleClick = () =&gt; { startTransition(() =&gt; { setCount(c =&gt; c + 1); }); }; return ( &lt;div&gt; &lt;h1&gt;計數: {count}&lt;/h1&gt; &lt;button onClick={handleClick} disabled={isPending}&gt; {isPending ? &#39;更新中...&#39; : &#39;增加&#39;} &lt;/button&gt; &lt;/div&gt; ); } export default App; 2. Automatic Batching 自動批處理功能可以在 Monorepo 中的多個應用和庫中使用，以減少重新渲染次數。 // libs/my-lib/src/lib/my-lib.tsx import React, { useState } from &#39;react&#39;; export function MyLib() { const [count, setCount] = useState(0); const [text, setText] = useState(&#39;&#39;); const handleClick = () =&gt; { setCount(c =&gt; c + 1); setText(&#39;計數已更新&#39;); }; return ( &lt;div&gt; &lt;h1&gt;計數: {count}&lt;/h1&gt; &lt;p&gt;{text}&lt;/p&gt; &lt;button onClick={handleClick}&gt;增加&lt;/button&gt; &lt;/div&gt; ); } 3. Suspense for Data Fetching 在 Monorepo 中，我們可以使用 Suspense 來處理數據加載，這使得異步操作更加簡單和直觀。 // apps/my-app/src/app/app.tsx import React, { Suspense } from &#39;react&#39;; import { MyLib } from &#39;@my-workspace/my-lib&#39;; const DataComponent = React.lazy(() =&gt; import(&#39;./data-component&#39;)); function App() { return ( &lt;div&gt; &lt;h1&gt;React 18 與 Monorepo&lt;/h1&gt; &lt;Suspense fallback={&lt;div&gt;加載中...&lt;/div&gt;}&gt; &lt;DataComponent /&gt; &lt;/Suspense&gt; &lt;MyLib /&gt; &lt;/div&gt; ); } export default App; 總結 通過在 Monorepo 中應用 React 18 的新特性，我們可以顯著提升開發效率和應用性能： Concurrent Mode 提升了應用的響應速度。 Automatic Batching 減少了重新渲染次數。 Suspense for Data Fetching 使異步操作更加簡單。 這些特性在 Monorepo 中的應用，讓我們能夠更好地管理大型代碼庫，實現高效的開發流程。 參考資料 React 官方文檔 Nx 官方文檔 React 18 發布公告","headline":"React 18 與 Monorepo 的實際應用","image":"https://miro.medium.com/max/1400/1*HSisLuifMO6KbLfPOKtLow.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2023-03-16-blog-Monorepo&react18-1/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logo.png"},"name":"Darren Tu"},"url":"http://localhost:4000/blog/2023-03-16-blog-Monorepo&react18-1/"}</script>
<!-- End Jekyll SEO tag -->


  

  



  <meta name="theme-color" content="#61DAFB">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Darren">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<meta name="application-name" content="Darren">

<meta name="generator" content="Hydejack v9.1.6" />


<link rel="alternate" href="http://localhost:4000/blog/2023-03-16-blog-Monorepo&react18-1/" hreflang="zh-tw">

<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Darren" />


<link rel="shortcut icon"    href="/assets/icons/favicon.ico">
<link rel="apple-touch-icon" href="/assets/icons/icon-192x192.png">

<link rel="manifest" href="/assets/site.webmanifest">

<link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com">



<link rel="preload" href="/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG">

<link rel="dns-prefetch" href="/assets/js/search-worker-9.1.6.js" as="worker" id="_hrefSearch">





<script>!function(r,c){"use strict";function a(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=c.createElement("script"),e=(n.src=e,t&&a(n,"load",t,{once:!0}),c.scripts[0]);return e.parentNode.insertBefore(n,e),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=c.createElement("script");function o(){r._loaded=!0,t&&a(n,"load",t,{once:!0});var e=c.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():a(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){a(c.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}}(window,document);
!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);
!function(w) {
  w._baseURL = '/';
  w._publicPath = '/assets/js/';
  w._noPushState = false;
  w._noDrawer = false;
  w._noNavbar = false;
  w._noToc = false;
  w._noSearch = false;
  w._advertise = false;
  w._search = {
    DATA_URL: '/assets/sitedata.json?no-cache',
    STORAGE_KEY: 'mini-search/',
    INDEX_KEY: 'index--2024-09-14T22:29:52+08:00',
  };
  w._clapButton = false;
}(window);</script>


<script async src="/assets/bower_components/MathJax/es5/tex-mml-chtml.js" id="_MathJax"></script>


<!--[if gt IE 8]><!---->

  




<link rel="stylesheet" href="/assets/css/hydejack-9.1.6.css" id="_stylePreload">
<link rel="stylesheet" href="/assets/icomoon/style.css" id="_iconsPreload">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700%7CNoto+Sans:400,400i,700,700i&display=swap" id="_fontsPreload">



  <style id="_pageStyle">

html{--accent-color: #61DAFB;--accent-color-faded: rgba(97,218,251,0.5);--accent-color-highlight: rgba(97,218,251,0.1);--accent-color-darkened: #3cd1fa;--theme-color: #61DAFB;--dark-mode-body-bg: #273032;--dark-mode-border-color: #333d40}

</style>


<!--<![endif]-->


<!-- Add HTML tags here to be included in the head -->


</head>

<body class="no-break-layout">
  


<hy-push-state
  id="_pushState"
  replace-selector="#_main"
  link-selector="a[href]:not([href^='/assets/']):not(.external):not(.no-push-state)"
  script-selector="script"
  duration="500"
  hashchange
>
  
  
  <div id="_navbar" class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Jump to:</span>
    <div class="nav-btn-bar">
      <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened">
        <span class="sr-only">Navigation</span>
        <span class="icon-menu"></span>
      </a>
      <div class="nav-span"></div>
    </div>
  </div>
</div>
<hr class="sr-only" hidden />

  <main
  id="_main"
  class="content layout-post"
  role="main"
>
  <nav id="breadcrumbs" class="screen-only"><ul>
  
  
    <li><a href="/">home</a></li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/blog/">blog</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          <span>2023-03-16-blog-Monorepo&react18-1</span>
        
      </li>
    
  
</ul></nav>
  










<article id="post-blog-blog-Monorepo&react18-1" class="page post mb6" role="article">
  <header>
    <h1 class="post-title flip-project-title">
      
        React 18 與 Monorepo 的實際應用
      
    </h1>

    <div class="post-date">
      
      <span class="ellipsis mr1">
        <time datetime="2023-03-16T00:00:00+08:00">16 Mar 2023</time> in <span>Blog</span> 
      </span>
      
        
          
          
          
            
            
            <span class="ellipsis" data-tippy-content="Last modified at: 14 Sep 2024">
              <span class="sr-only">Last modified at:</span>
              <span class="icon-history"></span>
              <time datetime="2024-09-14T22:27:45+08:00">2024-09-14</time>
            </span>
          
        
      
    </div>

    
    
      
        <div class="img-wrapper lead aspect-ratio sixteen-nine flip-project-img">
          


<img
  
    src="https://miro.medium.com/max/1400/1*HSisLuifMO6KbLfPOKtLow.jpeg"
  
  alt="React 18 與 Monorepo 的實際應用"
  
  
  width="864"
  height="486"
  loading="lazy"
/>

        </div>
      
      
    

    



  


  </header>

  
    <ol id="markdown-toc">
  <li><a href="#前言" id="markdown-toc-前言">前言</a></li>
  <li><a href="#monorepo-簡介" id="markdown-toc-monorepo-簡介">Monorepo 簡介</a></li>
  <li><a href="#設置-monorepo" id="markdown-toc-設置-monorepo">設置 Monorepo</a>    <ol>
      <li><a href="#1-初始化-nx-工作區" id="markdown-toc-1-初始化-nx-工作區">1. 初始化 Nx 工作區</a></li>
      <li><a href="#2-添加-react-應用" id="markdown-toc-2-添加-react-應用">2. 添加 React 應用</a></li>
      <li><a href="#3-添加-react-庫" id="markdown-toc-3-添加-react-庫">3. 添加 React 庫</a></li>
    </ol>
  </li>
  <li><a href="#在-monorepo-中使用-react-18" id="markdown-toc-在-monorepo-中使用-react-18">在 Monorepo 中使用 React 18</a>    <ol>
      <li><a href="#1-concurrent-mode" id="markdown-toc-1-concurrent-mode">1. Concurrent Mode</a></li>
      <li><a href="#2-automatic-batching" id="markdown-toc-2-automatic-batching">2. Automatic Batching</a></li>
      <li><a href="#3-suspense-for-data-fetching" id="markdown-toc-3-suspense-for-data-fetching">3. Suspense for Data Fetching</a></li>
    </ol>
  </li>
  <li><a href="#總結" id="markdown-toc-總結">總結</a></li>
  <li><a href="#參考資料" id="markdown-toc-參考資料">參考資料</a></li>
</ol>

<h2 id="前言">前言</h2>

<p>在現代前端開發中，Monorepo 已經成為管理大型代碼庫的一種流行方式。React 18 帶來了許多新特性，這些特性在 Monorepo 中的應用可以進一步提升開發效率和應用性能。本文將介紹如何在 Monorepo 中實際應用 React 18。</p>

<h2 id="monorepo-簡介">Monorepo 簡介</h2>

<p>Monorepo 是指將多個項目存放在同一個代碼庫中，這樣可以更好地管理依賴關係、共享代碼和統一配置。常見的 Monorepo 工具有 Lerna 和 Nx。</p>

<h2 id="設置-monorepo">設置 Monorepo</h2>

<p>首先，我們需要設置一個 Monorepo。這裡我們使用 Nx 作為示例。</p>

<h3 id="1-初始化-nx-工作區">1. 初始化 Nx 工作區</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">bash</span>
<span class="nx">npx</span> <span class="nx">create</span><span class="o">-</span><span class="nx">nx</span><span class="o">-</span><span class="nx">workspace</span><span class="p">@</span><span class="nd">latest</span> <span class="nx">my</span><span class="o">-</span><span class="nx">workspace</span>
<span class="nx">cd</span> <span class="nx">my</span><span class="o">-</span><span class="nx">workspace</span>
</code></pre></div></div>

<h3 id="2-添加-react-應用">2. 添加 React 應用</h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">bash</span>
<span class="nx">nx</span> <span class="nx">generate</span> <span class="p">@</span><span class="nd">nrwl</span><span class="sr">/react:application my-ap</span><span class="err">p
</span></code></pre></div></div>

<h3 id="3-添加-react-庫">3. 添加 React 庫</h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">bash</span>
<span class="nx">nx</span> <span class="nx">generate</span> <span class="p">@</span><span class="nd">nrwl</span><span class="sr">/react:library my-li</span><span class="err">b
</span></code></pre></div></div>

<h2 id="在-monorepo-中使用-react-18">在 Monorepo 中使用 React 18</h2>

<h3 id="1-concurrent-mode">1. Concurrent Mode</h3>

<p>在 Monorepo 中，我們可以在應用和庫中使用 React 18 的 Concurrent Mode 來提升性能。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// apps/my-app/src/app/app.tsx</span>
<span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">useState</span><span class="p">,</span> <span class="nx">useTransition</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">isPending</span><span class="p">,</span> <span class="nx">startTransition</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useTransition</span><span class="p">();</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">count</span><span class="p">,</span> <span class="nx">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">startTransition</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">setCount</span><span class="p">(</span><span class="nx">c</span> <span class="o">=&gt;</span> <span class="nx">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">計數</span><span class="p">:</span> <span class="p">{</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}</span> <span class="nx">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isPending</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="nx">isPending</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">更新中...</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">增加</span><span class="dl">'</span><span class="p">}</span>
      <span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="2-automatic-batching">2. Automatic Batching</h3>

<p>自動批處理功能可以在 Monorepo 中的多個應用和庫中使用，以減少重新渲染次數。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// libs/my-lib/src/lib/my-lib.tsx</span>
<span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">useState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">MyLib</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">count</span><span class="p">,</span> <span class="nx">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">text</span><span class="p">,</span> <span class="nx">setText</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setCount</span><span class="p">(</span><span class="nx">c</span> <span class="o">=&gt;</span> <span class="nx">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="nx">setText</span><span class="p">(</span><span class="dl">'</span><span class="s1">計數已更新</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">計數</span><span class="p">:</span> <span class="p">{</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">增加</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="3-suspense-for-data-fetching">3. Suspense for Data Fetching</h3>

<p>在 Monorepo 中，我們可以使用 Suspense 來處理數據加載，這使得異步操作更加簡單和直觀。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// apps/my-app/src/app/app.tsx</span>
<span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Suspense</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MyLib</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@my-workspace/my-lib</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">DataComponent</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">lazy</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">import</span><span class="p">(</span><span class="dl">'</span><span class="s1">./data-component</span><span class="dl">'</span><span class="p">));</span>

<span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">React</span> <span class="mi">18</span> <span class="nx">與</span> <span class="nx">Monorepo</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">Suspense</span> <span class="nx">fallback</span><span class="o">=</span><span class="p">{</span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">加載中</span><span class="p">...</span><span class="o">&lt;</span><span class="sr">/div&gt;}</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">DataComponent</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="sr">/Suspense</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">MyLib</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="總結">總結</h2>

<p>通過在 Monorepo 中應用 React 18 的新特性，我們可以顯著提升開發效率和應用性能：</p>

<ol>
  <li>Concurrent Mode 提升了應用的響應速度。</li>
  <li>Automatic Batching 減少了重新渲染次數。</li>
  <li>Suspense for Data Fetching 使異步操作更加簡單。</li>
</ol>

<p>這些特性在 Monorepo 中的應用，讓我們能夠更好地管理大型代碼庫，實現高效的開發流程。</p>

<h2 id="參考資料">參考資料</h2>
<ul>
  <li><a href="https://reactjs.org/">React 官方文檔</a></li>
  <li><a href="https://nx.dev/">Nx 官方文檔</a></li>
  <li><a href="https://reactjs.org/blog/2022/03/29/react-v18.html">React 18 發布公告</a></li>
</ul>

  
</article>


<!--  -->
<section id="clapper" class="mb6">
  <applause-button style="margin: 0 auto;width: 120px; height: 120px" color="rgb(17, 128, 127)"></applause-button>
</section>


  <p class="message centered border-radius" >
    <span style="display:block;margin-bottom:.5rem;">喜歡就給個鼓勵！ <br> A clap is much appreciated if you enjoyed. No sign up or cost associated :)</span>
  </p>







  
     


  <aside class="about related mt4 mb4" role="complementary">
    
    

<div class="author mt4">
  

  
    


<img
  
    src="/assets/img/avatar.jpg"
    srcset="/assets/img/avatar.jpg 1x,/assets/img/avatar.jpg 2x"
    
  
  alt="Darren Tu"
  class="avatar"
  
  width="120"
  height="120"
  loading="lazy"
/>

  

  
  
  <h2  class="page-title hr-bottom">
    About
  </h2>

  <ul>
  <li>10年的網站開發經驗，擅長產品開發、UIUX介面。</li>
  <li>互動電子白板、數位看板系統、電子商務、媒體健康類網頁APP開發。</li>
  <li>與產品團隊、設計團隊密切合作良好溝通協調能力。</li>
  <li>熟練 MVC / MVVM Pattern 前後分離架構。</li>
  <li>Sass / SCSS 模組化，vite/webpack 等構建工具，Git 協同開發流程。</li>
  <li>分析客戶數據，市場信息和競爭製定營銷策略。</li>
</ul>


  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://gitlab.com/darrentu88" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:darrentu8@gmail.com" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://www.instagram.com/tu_d/" title="Instagram" class="no-mark-external">
      <span class="icon-instagram"></span>
      <span class="sr-only">Instagram</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>

  </aside>


  

  
    


  

  
    


  <aside class="other-projects related mb0" role="complementary">  <h2>Related Posts</h2>  <div class="columns">          <div class="column column-1-2">                  <article class="project-card">  <a href="/blog/2024-04-27-blog-react19-2/" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine flip-project-img">              <img      src="https://miro.medium.com/max/1400/1*HSisLuifMO6KbLfPOKtLow.jpeg"    alt="React 19 進階技巧與最佳實踐"      width="864"  height="486"  loading="lazy"/>          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/blog/2024-04-27-blog-react19-2/" class="flip-title">React 19 進階技巧與最佳實踐</a>  </h3>      <a class="fill-card no-hover" href="/blog/2024-04-27-blog-react19-2/" tabindex="-1"><span class="sr-only">Continue reading React 19 進階技巧與最佳實踐</span></a></article>              </div>          <div class="column column-1-2">                  <article class="project-card">  <a href="/blog/2024-04-16-blog-react19-1/" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine flip-project-img">              <img      src="https://miro.medium.com/max/1400/1*HSisLuifMO6KbLfPOKtLow.jpeg"    alt="React 19 的新特性與應用技巧"      width="864"  height="486"  loading="lazy"/>          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/blog/2024-04-16-blog-react19-1/" class="flip-title">React 19 的新特性與應用技巧</a>  </h3>      <a class="fill-card no-hover" href="/blog/2024-04-16-blog-react19-1/" tabindex="-1"><span class="sr-only">Continue reading React 19 的新特性與應用技巧</span></a></article>              </div>      </div></aside>

  

  
    


  <aside class="related mb4" role="complementary">  <h2 class="hr-bottom">Random Posts</h2>  <ul class="related-posts">          <li class="h4">  <a href="/blog/2024-04-16-blog-react19-1/" class="flip-title"><span>React 19 的新特性與應用技巧</span></a>  <time class="faded fine" datetime="2024-04-16T00:00:00+08:00">16 Apr 2024</time></li>          <li class="h4">  <a href="/blog/2023-01-09-blog-vue3&Pinia/" class="flip-title"><span>Pinia 在 Vue 3 中的進階應用技巧</span></a>  <time class="faded fine" datetime="2023-01-09T00:00:00+08:00">09 Jan 2023</time></li>          <li class="h4">  <a href="/blog/2018-12-19-blog-submodule/" class="flip-title"><span>Git - 如何在現有的專案中建立子repository模塊， submodule 使用教學 - GitHub</span></a>  <time class="faded fine" datetime="2018-12-19T00:00:00+08:00">19 Dec 2018</time></li>      </ul></aside>

  

  
    

  


  
<footer class="content" role="contentinfo">
  <hr/>
  
    <p><small class="copyright">© 2021. All rights reserved.
</small></p>
  
  
  
  <hr class="sr-only"/>
</footer>


</main>

  <hy-drawer
  id="_drawer"
  class=""
  side="left"
  threshold="10"
  noscroll
  
>
  <header id="_sidebar" class="sidebar" role="banner">
    




<div class="sidebar-bg " style="background:url('https://www.pbs.org/wgbh/nova/media/images/bfcppfu.width-800.png') center/cover"></div>

    <div class="sidebar-sticky">
  <div class="sidebar-about">
    
      <a class="no-hover" href="/" tabindex="-1">
        <img src="/assets/img/logo.png" class="avatar" alt="Darren" width="120" height="120" loading="lazy" />
      </a>
    
    <a class="sidebar-title" href="/"><h2 class="h1">Darren</h2></a>
    
    
      <p class="">
        A blog, portfolio, and resume.

      </p>
    
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    <span class="sr-only">Navigation:</span>
<ul>
  
    
      
      <li>
        <a
          id="_drawer--opened"
          href="/blog/"
          class="sidebar-nav-item "
          
        >
          Blog
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/projects/"
          class="sidebar-nav-item "
          
        >
          Showcase
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/about/"
          class="sidebar-nav-item "
          
        >
          About Me
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/resume/"
          class="sidebar-nav-item "
          
        >
          Resume
        </a>
      </li>
    
  
</ul>

  </nav>

  
  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://gitlab.com/darrentu88" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:darrentu8@gmail.com" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://www.instagram.com/tu_d/" title="Instagram" class="no-mark-external">
      <span class="icon-instagram"></span>
      <span class="sr-only">Instagram</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>
  </header>
</hy-drawer>
<hr class="sr-only" hidden />

</hy-push-state>


  <!--[if gt IE 10]><!---->
  <script nomodule>!function(){var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())}();
</script>
  <script src="/assets/js/hydejack-9.1.6.js" type="module"></script>
  <script src="/assets/js/LEGACY-hydejack-9.1.6.js" nomodule defer></script>
  

  

  <script type="module">
    if ('serviceWorker' in navigator) {
      /**/
      navigator.serviceWorker.getRegistration()
        .then(r => r.unregister())
        .catch(() => {});
      /**/
    }
  </script>
<!--<![endif]-->
  <!-- <script>
  document.querySelector('hy-push-state').setAttribute('prefetch', '');

  document.querySelectorAll('.sidebar a[href^="/"]').forEach(function (el) { 
    el.addEventListener('click', function (e) {
      if (el.pathname === window.location.pathname) {
        e.preventDefault();
        e.stopPropagation();
        document.querySelector('hy-drawer').close();
      }
    });
  });
</script> -->

<!--
Code for integrating CloudFlare's email protection with Hydejack's single page app loading.
-->
<script>
  document.getElementById('_pushState').addEventListener('hy-push-state-after', function (e) {
    function e(e){
      (console.error?console.error:console.log).call(console,e)
    }

    function t(e){
      return l.innerHTML='<a href="'+e.replace(/"/g,"&quot;")+'"></a>',l.childNodes[0].getAttribute("href")
    }

    function r(e,t){
      var r=e.substr(t,2);return parseInt(r,16)
    }

    function n(e,n){
      for(var o="",c=r(e,n),a=n+2;a<e.length;a+=2){
        var l=r(e,a)^c;
        o+=String.fromCharCode(l)
      }
      return t(o)
    }

    var o="/cdn-cgi/l/email-protection#",
        c=".__cf_email__",
        a="data-cfemail",
        l=document.createElement("div");

    !function(){
      for(var t=document.getElementsByTagName("a"),r=0;r<t.length;r++)
        try{
          var c=t[r],a=c.href.indexOf(o);
          a>-1&&(c.href="mailto:"+n(c.href,a+o.length))
        }catch(t){
          e(t)
        }
    }(),
    function(){
      for(var t=document.querySelectorAll(c),r=0;r<t.length;r++)
        try{
          var o=t[r],l=n(o.getAttribute(a),0),i=document.createTextNode(l);
          o.parentNode.replaceChild(i,o)
        }catch(t){
          e(t)
        }
    }()
  });
</script>





<div hidden>
  
  <h2 class="sr-only">Templates (for web app):</h2>

  <template id="_animation-template">
  <div class="animation-main fixed-top">
    <nav id="breadcrumbs" class="screen-only"><ul>
  
  
</ul></nav>
    <div class="content">
      <div class="page"></div>
    </div>
  </div>
</template>

  <template id="_loading-template">
  <div class="loading nav-btn fr">
    <span class="sr-only">Loading…</span>
    <span class="icon-cog"></span>
  </div>
</template>

  <template id="_error-template">
  <div class="page">
    <h1 class="page-title">Error</h1>
    
    
    <p class="lead">
      Sorry, an error occurred while loading <a class="this-link" href=""></a>.

    </p>
  </div>
</template>

  <template id="_permalink-template">
  <a href="#" class="permalink">
    <span class="sr-only">Permalink</span>
    <span class="content-hash"></span>
  </a>
</template>

  
  
    <template id="_dark-mode-template">
  <button id="_dark-mode" class="nav-btn no-hover" >
    <span class="sr-only">Dark Mode</span>
    <span class="icon-brightness-contrast"></span>
  </button>
</template>

  
  
    <template id="_search-template">
  <button id="_search" class="nav-btn no-hover">
    <label class="sr-only" for="_search-input">Search</label>
    <span class="icon-search"></span>
  </button>
  <div id="_search-box">
    <div class="nav-btn">
      <span class="icon-search"></span>
    </div>
    <input 
      id="_search-input"
      type="search"
      class="form-control form-control-lg nav-btn"
      placeholder="Build with JEKYLL_ENV=production to enable search."
    />
    <button type="reset" class="nav-btn no-hover">
      <span class="sr-only">Close</span>
      <span class="icon-cross"></span>
    </button>
  </div>
  <div id="_hits"></div>
</template>

  
</div>

</body>
</html>
